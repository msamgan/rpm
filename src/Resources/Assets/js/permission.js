$(function(){var e=$("#permission-form"),t=$("table"),a=$("#permission-table").DataTable({processing:!0,serverSide:!0,pageLength:20,order:[[0,"desc"]],ajax:{url:"/load/permissions"},columns:[{data:"id",name:"id"},{data:"name",name:"name"},{data:"route_name",name:"route_name"},{data:"group_name",name:"group_name"},{data:"description",name:"description"},{data:"action",name:"action"}]});e.on("submit",function(t){t.preventDefault();var o=$("#permission-save"),r="/store/permission";"edit"==o.attr("data-action")&&(r="update/permission/"+o.attr("data-id")),$.post(r,e.serialize(),function(t){t.status?(a.draw(),$("#permission-form-modal").modal("hide"),e.get(0).reset()):$.alert({theme:"dark",title:"ERROR!",content:t.message})})}),t.on("click",".edit-permission",function(){var e=$(this).data("id");$("#more-route-name-section").html(""),$.get("/permission/"+e,function(t){if(console.log(t),t.status){var a=$("#permission-save");$("#name").val(t.data.name),$("#description").val(t.data.description),$("#permissionGroup").val(t.data.permission_group_id),$("#routeName").val(t.data.permission_routes[0].route_name),a.attr("data-action","edit"),a.attr("data-id",e),$("#permission-form-modal").modal("show"),$.each(t.data.permission_routes,function(e,t){if(0!=e){var a=Math.floor(100*Math.random()+1);$("#more-route-name-section").append('<div id="'+a+'"><input type="text" class="form-control mt-2" id="" name="route_name[]" required placeholder="Name of the Route permission to be applied" value="'+t.route_name+'"><small style="float: right; cursor: pointer; color: red" class="form-text mb-2 remove-route-name" data-id="'+a+'" >Remove</small></div>')}})}})}),t.on("click",".delete-permission",function(){var e=$(this).data("id");$.confirm({theme:"dark",title:"Confirm!",content:"Are you sure!",buttons:{confirm:{btnClass:"btn-red",action:function(){$.get("/permission/delete/"+e,function(e){if(e.status)return a.draw();$.alert({theme:"dark",title:"ERROR!",content:"Oops! our bad, please try again later."})})}},cancel:function(){}}})}),$("#add-permission-btn").click(function(){var t=$("#permission-save");$("#more-route-name-section").html(""),e.get(0).reset(),t.attr("data-action","add"),t.attr("data-id","")}),$("#add-more-route-name").on("click",function(){var e=Math.floor(100*Math.random()+1);$("#more-route-name-section").append('<div id="'+e+'"><input type="text" class="form-control mt-2" id="" name="route_name[]" required placeholder="Name of the Route permission to be applied"><small style="float: right; cursor: pointer; color: red" class="form-text mb-2 remove-route-name" data-id="'+e+'" >Remove</small></div>')}),$("#more-route-name-section").on("click",".remove-route-name",function(){$("#"+$(this).data("id")).remove()})});
